{{extend 'layout.html'}}

<div class="post_listing center">

    {{logged_in = auth.user_id is not None}}

    <div class="page-header clearfix">
        <h2 class="pull-left">GroupThink: Enrolled Courses</h2>
        {{if logged_in:}}
            <a href="{{=URL('default', 'join')}}" class="btn btn-info pull-right pull-right">
                <i class="fa fa-plus"></i> Join Course
            </a>
        {{else:}}
            <a href="{{=URL('default', 'user', args=['login'])}}" class="btn btn-warning pull-right">
                    Log in <i class="fa fa-sign-in"></i>
            </a>
        {{pass}}
    </div>


    <div class="text-left">
    {{if courses:}}
        {{myCourses = []}}
        {{for r in students:}}
            {{if (r.user_email == auth.user.email):}}
                {{myCourses = r.enrolled_courses}}
            {{pass}}
        {{pass}}

        {{for c in courses:}}
            {{own_p = auth.user_id and c.admin_email == auth.user.email}}
            {{for d in myCourses:}}
                {{if c.course_name == d:}}
                    <div class="panel {{='panel-info' if own_p else 'panel-primary'}}">
                        <div class="panel-heading clearfix">

                            {{if own_p:}}
                                <a href="{{=URL('default', 'edit_course', args=[c.id])}}" class="btn btn-primary btn-sm pull-right">
                                    Edit <i class="fa fa-pencil-square-o"></i>
                                </a>
                            {{pass}}
                        </div>
                        <div class="panel-body">
                            <p>Course Name: {{=c.course_name}}</p>
                            <p>Course ID: {{=c.course_id}} </p>
                            <p>Course Information: {{=c.course_info}}</p>
                        </div>
                        <div class="panel-footer clearfix">
                            <span class="badge pull-right">#{{=c.id}}</span>
                        </div>
                    </div>
                {{pass}}
            {{pass}}
        {{pass}}
    {{else:}}
        <div class="alert alert-warning" role="alert">
            There aren't any classes yet!
        </div>
    {{pass}}
    </div>
</div>
